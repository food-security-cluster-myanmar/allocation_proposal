state_moderate = moderately_insecure,
state_severe = severely_insecure,
state_insecure = insecure),
by = "state") %>%
mutate_at(vars(conflict_score, mdp_adjust),
~ range_wna(.x)) %>%
mutate(conflict_affected = conflict_score * population_2021_proj,
vulnerable = mdp_adjust * population_2021_proj) %>%
replace_na(list(conflict_score = 0, vulnerable = 0)) %>%
group_by(state) %>%
mutate(caseload = pmax(conflict_affected, vulnerable),
pc_caseload = caseload / sum(caseload),
tsp_moderate = state_moderate * pc_caseload,
tsp_severe = state_severe * pc_caseload,
tsp_pin = tsp_moderate + tsp_severe) %>%
select(state, township, admin3_pcode,
conflict_score, mdp_adjust,
conflict_affected,
mdp_adjust,
caseload,
tsp_moderate,
tsp_severe,
tsp_pin) %>%
ungroup()
nat %>%
filter(state == "Ayeyarwady") %>%
nat_table()
nat
nat %>%
filter(state == "Ayeyarwady") %>%
select(township,
admin3_pcode,
conflict_affected,
pre_ex_vulnerable = mdp_adjust,
moderately_insecure = tsp_moderate,
severely_insecure = tsp_severe,
PIN = tsp_pin) %>%
mutate(`%_PIN` = round(PIN / sum(PIN) * 100,
digits = 2))
nat_table <- function(tbl){
tbl %>%
select(township,
admin3_pcode,
conflict_affected,
pre_ex_vulnerable = mdp_adjust,
moderately_insecure = tsp_moderate,
severely_insecure = tsp_severe,
PIN = tsp_pin) %>%
mutate(`%_PIN` = round(PIN / sum(PIN) * 100,
digits = 2))
}
nat %>%
filter(state == "Ayeyarwady") %>%
nat_table()
nat_table <- function(tbl){
tbl %>%
select(township,
admin3_pcode,
conflict_affected,
pre_ex_vulnerable = vulnerable,
moderately_insecure = tsp_moderate,
severely_insecure = tsp_severe,
PIN = tsp_pin) %>%
mutate(`%_PIN` = round(PIN / sum(PIN) * 100,
digits = 2)) %>%
mutate_at(where(is.numeric),
~ round(.x))
}
nat %>%
filter(state == "Ayeyarwady") %>%
nat_table()
nat_table <- function(tbl){
tbl %>%
select(township,
admin3_pcode,
conflict_affected,
pre_ex_vulnerable = vulnerable,
moderately_insecure = tsp_moderate,
severely_insecure = tsp_severe,
PIN = tsp_pin) %>%
mutate(`%_PIN` = round(PIN / sum(PIN) * 100,
digits = 2)) %>%
mutate_if(where(is.numeric),
~ round(.x))
}
nat %>%
filter(state == "Ayeyarwady") %>%
nat_table()
nat <- pin %>%
mutate(state = recode(state,
"Bago (East)" = "Bago",
"Bago (West)" = "Bago",
"Shan (North)" = "Shan",
"Shan (East)" = "Shan",
"Shan (South)" = "Shan")) %>%
left_join(states %>%
mutate(
population = pc / 100 * 53431391.27,
moderately_insecure = moderately_insecure / 100 * population,
severely_insecure = severely_insecure / 100 * population,
PIN = (moderately_insecure + severely_insecure),
`%_PIN` = round(PIN / sum(PIN, na.rm = TRUE) * 100,
digits = 2),
insecure = moderately_insecure + severely_insecure
) %>%
mutate_at(vars(moderately_insecure,
severely_insecure,
insecure),
~ round(.x)) %>%
arrange(desc(insecure)) %>%
select(state,
state_moderate = moderately_insecure,
state_severe = severely_insecure,
state_insecure = insecure),
by = "state") %>%
mutate_at(vars(conflict_score, mdp_adjust),
~ range_wna(.x)) %>%
mutate(conflict_affected = conflict_score * population_2021_proj,
vulnerable = mdp_adjust * population_2021_proj) %>%
replace_na(list(conflict_score = 0, vulnerable = 0)) %>%
group_by(state) %>%
mutate(caseload = pmax(conflict_affected, vulnerable),
pc_caseload = caseload / sum(caseload),
tsp_moderate = state_moderate * pc_caseload,
tsp_severe = state_severe * pc_caseload,
tsp_pin = tsp_moderate + tsp_severe) %>%
select(state, township, admin3_pcode,
conflict_score, mdp_adjust,
conflict_affected,
vulnerable,
caseload,
tsp_moderate,
tsp_severe,
tsp_pin) %>%
ungroup()
nat %>%
filter(state == "Ayeyarwady") %>%
nat_table()
nat_table <- function(tbl){
tbl %>%
select(township,
admin3_pcode,
conflict_affected,
pre_ex_vulnerable = vulnerable,
moderately_insecure = tsp_moderate,
severely_insecure = tsp_severe,
PIN = tsp_pin) %>%
mutate(`%_PIN` = round(PIN / sum(PIN) * 100,
digits = 2)) %>%
mutate_if(is.numeric,
~ round(.x))
}
nat %>%
filter(state == "Ayeyarwady") %>%
nat_table()
nat_table <- function(tbl){
tbl %>%
select(township,
admin3_pcode,
conflict_affected,
pre_ex_vulnerable = vulnerable,
moderately_insecure = tsp_moderate,
severely_insecure = tsp_severe,
PIN = tsp_pin) %>%
mutate_if(is.numeric,
~ round(.x)) %>%
mutate(`%_PIN` = round(PIN / sum(PIN) * 100,
digits = 2)) %>%
arrange(desc(PIN))
flextable() %>%
set_caption()
}
nat_table <- function(tbl){
tbl %>%
select(township,
admin3_pcode,
conflict_affected,
pre_ex_vulnerable = vulnerable,
moderately_insecure = tsp_moderate,
severely_insecure = tsp_severe,
PIN = tsp_pin) %>%
mutate_if(is.numeric,
~ round(.x)) %>%
mutate(`%_PIN` = round(PIN / sum(PIN) * 100,
digits = 2)) %>%
arrange(desc(PIN)) %>%
flextable() %>%
set_caption("Proposed PIN breakdown by township") %>%
theme_zebra()
}
nat %>%
filter(state == "Ayeyarwady") %>%
nat_table()
nat %>%
filter(state == "Bago") %>%
nat_table()
nat <- pin %>%
mutate(state = recode(state,
"Bago (East)" = "Bago",
"Bago (West)" = "Bago",
"Shan (North)" = "Shan",
"Shan (East)" = "Shan",
"Shan (South)" = "Shan")) %>%
left_join(states %>%
mutate(
population = pc / 100 * 53431391.27,
moderately_insecure = moderately_insecure / 100 * population,
severely_insecure = severely_insecure / 100 * population,
PIN = (moderately_insecure + severely_insecure),
`%_PIN` = round(PIN / sum(PIN, na.rm = TRUE) * 100,
digits = 2),
insecure = moderately_insecure + severely_insecure
) %>%
mutate_at(vars(moderately_insecure,
severely_insecure,
insecure),
~ round(.x)) %>%
arrange(desc(insecure)) %>%
select(state,
state_moderate = moderately_insecure,
state_severe = severely_insecure,
state_insecure = insecure),
by = "state") %>%
mutate_at(vars(conflict_score, mdp_adjust),
~ range_wna(.x)) %>%
mutate(conflict_affected = conflict_score * population_2021_proj,
vulnerable = mdp_adjust * population_2021_proj) %>%
replace_na(list(conflict_score = 0, vulnerable = 0)) %>%
group_by(state) %>%
mutate(caseload = pmax(conflict_affected, vulnerable),
pc_caseload = caseload / sum(caseload),
tsp_moderate = state_moderate * pc_caseload,
tsp_severe = state_severe * pc_caseload,
tsp_pin = tsp_moderate + tsp_severe) %>%
select(state, township, admin3_pcode,
population = population_2021_proj,
conflict_score, mdp_adjust,
conflict_affected,
vulnerable,
caseload,
tsp_moderate,
tsp_severe,
tsp_pin) %>%
ungroup()
nat_table <- function(tbl){
tbl %>%
select(township,
admin3_pcode,
population,
conflict_affected,
pre_ex_vulnerable = vulnerable,
moderately_insecure = tsp_moderate,
severely_insecure = tsp_severe,
PIN = tsp_pin) %>%
mutate_if(is.numeric,
~ round(.x)) %>%
mutate(`%_PIN` = round(PIN / sum(PIN) * 100,
digits = 2)) %>%
arrange(desc(PIN)) %>%
flextable() %>%
set_caption("Proposed PIN breakdown by township") %>%
theme_zebra()
}
nat %>%
filter(state == "Ayeyarwady") %>%
nat_table()
nat_table <- function(tbl){
tbl %>%
select(township,
admin3_pcode,
population,
conflict_affected,
pre_ex_vulnerable = vulnerable,
moderately_insecure = tsp_moderate,
severely_insecure = tsp_severe,
PIN = tsp_pin) %>%
mutate_if(is.numeric,
~ round(.x)) %>%
mutate(`%_PIN` = round(PIN / sum(PIN) * 100,
digits = 2)) %>%
arrange(desc(PIN)) %>%
flextable() %>%
set_caption("Proposed PIN breakdown by township") %>%
theme_zebra() %>%
fontsize(size = 3, part = "all")
}
nat %>%
filter(state == "Ayeyarwady") %>%
nat_table()
nat_table <- function(tbl){
tbl %>%
select(township,
admin3_pcode,
population,
conflict_affected,
pre_ex_vulnerable = vulnerable,
moderately_insecure = tsp_moderate,
severely_insecure = tsp_severe,
PIN = tsp_pin) %>%
mutate_if(is.numeric,
~ round(.x)) %>%
mutate(`%_PIN` = round(PIN / sum(PIN) * 100,
digits = 2)) %>%
arrange(desc(PIN)) %>%
flextable() %>%
set_caption("Proposed PIN breakdown by township") %>%
theme_zebra() %>%
fontsize(size = 7, part = "all")
}
nat %>%
filter(state == "Ayeyarwady") %>%
nat_table()
nat_table <- function(tbl){
tbl %>%
select(township,
admin3_pcode,
population,
conflict_affected,
pre_ex_vulnerable = vulnerable,
moderately_insecure = tsp_moderate,
severely_insecure = tsp_severe,
PIN = tsp_pin) %>%
mutate_if(is.numeric,
~ round(.x)) %>%
mutate(`%_PIN` = round(PIN / sum(PIN) * 100,
digits = 2)) %>%
arrange(desc(PIN)) %>%
flextable() %>%
set_caption("Proposed PIN breakdown by township") %>%
theme_zebra() %>%
fontsize(size = 9, part = "all")
}
nat %>%
filter(state == "Ayeyarwady") %>%
nat_table()
nat_table <- function(tbl){
tbl %>%
select(township,
pcode = admin3_pcode,
population,
`conflict affected`,
`pre-ex. vulnerable` = vulnerable,
`moderately insecure` = tsp_moderate,
`severely insecure` = tsp_severe,
PIN = tsp_pin) %>%
mutate_if(is.numeric,
~ round(.x)) %>%
mutate(`%_PIN` = round(PIN / sum(PIN) * 100,
digits = 2)) %>%
arrange(desc(PIN)) %>%
flextable() %>%
set_caption("Proposed PIN breakdown by township") %>%
theme_zebra() %>%
fontsize(size = 9, part = "all")
}
nat %>%
filter(state == "Ayeyarwady") %>%
nat_table()
nat_table <- function(tbl){
tbl %>%
select(township,
pcode = admin3_pcode,
population,
`conflict affected` = conflict_affected,
`pre-ex. vulnerable` = vulnerable,
`moderately insecure` = tsp_moderate,
`severely insecure` = tsp_severe,
PIN = tsp_pin) %>%
mutate_if(is.numeric,
~ round(.x)) %>%
mutate(`%_PIN` = round(PIN / sum(PIN) * 100,
digits = 2)) %>%
arrange(desc(PIN)) %>%
flextable() %>%
set_caption("Proposed PIN breakdown by township") %>%
theme_zebra() %>%
fontsize(size = 9, part = "all")
}
nat %>%
filter(state == "Ayeyarwady") %>%
nat_table()
tbl %>%
select(township,
pcode = admin3_pcode,
population,
`conflict affected` = conflict_affected,
`pre-ex. vulnerable` = vulnerable,
`moderately insecure` = tsp_moderate,
`severely insecure` = tsp_severe,
PIN = tsp_pin) %>%
mutate_if(is.numeric,
~ round(.x)) %>%
mutate(`%_PIN` = round(PIN / sum(PIN) * 100,
digits = 2)) %>%
arrange(desc(PIN)) %>%
flextable() %>%
set_caption("Proposed PIN breakdown by township") %>%
theme_zebra() %>%
fontsize(size = 11, part = "all")
nat_table <- function(tbl){
tbl %>%
select(township,
pcode = admin3_pcode,
population,
`conflict affected` = conflict_affected,
`pre-ex. vulnerable` = vulnerable,
`moderately insecure` = tsp_moderate,
`severely insecure` = tsp_severe,
PIN = tsp_pin) %>%
mutate_if(is.numeric,
~ round(.x)) %>%
mutate(`%_PIN` = round(PIN / sum(PIN) * 100,
digits = 2)) %>%
arrange(desc(PIN)) %>%
flextable() %>%
set_caption("Proposed PIN breakdown by township") %>%
theme_zebra() %>%
fontsize(size = 11, part = "all")
}
nat %>%
filter(state == "Ayeyarwady") %>%
nat_table()
nat %>%
filter(state == "Bago") %>%
nat_table()
nat %>%
filter(state == "Chin") %>%
nat_table()
nat %>%
distinct(state)
nat %>%
filter(state == "Kachin") %>%
nat_table()
nat %>%
filter(state == "Kayah") %>%
nat_table()
nat %>%
filter(state == "Kayin") %>%
nat_table()
nat_table <- function(tbl){
tbl %>%
select(township,
pcode = admin3_pcode,
population,
`conflict affected` = conflict_affected,
`pre-ex. vulnerable` = vulnerable,
`moderately insecure` = tsp_moderate,
`severely insecure` = tsp_severe,
PIN = tsp_pin) %>%
mutate_if(is.numeric,
~ round(.x)) %>%
mutate(`%_PIN` = round(PIN / sum(PIN) * 100,
digits = 2)) %>%
arrange(desc(PIN)) %>%
adorn_totals("row") %>%
flextable() %>%
set_caption("Proposed PIN breakdown by township") %>%
theme_zebra() %>%
fontsize(size = 11, part = "all")
}
nat %>%
filter(state == "Ayeyarwady") %>%
nat_table()
nat_table <- function(tbl){
tbl %>%
select(township,
pcode = admin3_pcode,
population,
`conflict affected` = conflict_affected,
`pre-ex. vulnerable` = vulnerable,
`moderately insecure` = tsp_moderate,
`severely insecure` = tsp_severe,
PIN = tsp_pin) %>%
mutate_if(is.numeric,
~ round(.x)) %>%
mutate(`%_PIN` = round(PIN / sum(PIN) * 100,
digits = 2)) %>%
arrange(desc(PIN)) %>%
adorn_totals("row") %>%
mutate(`%_PIN` = ifelse(`%_PIN` > 90 & `%_PIN` < 110,
100, `%_PIN`))
flextable() %>%
set_caption("Proposed PIN breakdown by township") %>%
theme_zebra() %>%
fontsize(size = 11, part = "all")
}
nat_table <- function(tbl){
tbl %>%
select(township,
pcode = admin3_pcode,
population,
`conflict affected` = conflict_affected,
`pre-ex. vulnerable` = vulnerable,
`moderately insecure` = tsp_moderate,
`severely insecure` = tsp_severe,
PIN = tsp_pin) %>%
mutate_if(is.numeric,
~ round(.x)) %>%
mutate(`%_PIN` = round(PIN / sum(PIN) * 100,
digits = 2)) %>%
arrange(desc(PIN)) %>%
adorn_totals("row") %>%
mutate(`%_PIN` = ifelse(`%_PIN` > 90 & `%_PIN` < 110,
100, `%_PIN`)) %>%
flextable() %>%
set_caption("Proposed PIN breakdown by township") %>%
theme_zebra() %>%
fontsize(size = 11, part = "all")
}
nat %>%
filter(state == "Ayeyarwady") %>%
nat_table()
